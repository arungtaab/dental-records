<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes, viewport-fit=cover">
    <!-- Use mobile-web-app-capable instead of apple-specific deprecated tag -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Student Dental Records / Tala ng Ngipin ng Mag-aaral</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶∑</text></svg>">
    <style>
        .iframe-container {
            width: 100%;
            height: 800px;
            border: none;
            border-radius: 10px;
            background: white;
            position: relative;
        }

        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }

        .iframe-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .relative {
            position: relative;
        }

        .tab-content {
            overflow-y: auto;
            max-height: 800px;
            padding: 15px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Student Dental Records </h1>
        </div>

        <!-- Connection Status -->
        <div id="connectionStatus" class="status online">
            <span id="statusIcon">‚úÖ</span>
            <span id="statusText">You are online</span>
            <span id="pendingCount" class="pending-count hidden">0</span>
        </div>

        <!-- Three Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab(1)">
                <span class="en">ü¶∑ Student + Dental</span>
            </button>
            <button class="tab" onclick="switchTab(2)">
                <span class="en">üìä Analysis Dashboard</span>
            </button>
            <button class="tab" onclick="switchTab(3)">
                <span class="en">üìÖ Booking System</span>
            </button>
        </div>

        <!-- Content Area -->
        <div class="content">
            <!-- TAB 1: Student + Dental (all functionality) -->
            <div id="tab1" class="tab-content">
                <!-- Search Section -->
                <div class="search-section">
                    <h3><span class="en">üîç Search Student </span></h3>
                    <div class="search-grid">
                        <div class="form-group">
                            <label><span class="en">Complete Name</span></label>
                            <input type="text" id="searchName" placeholder="Enter full name">
                        </div>
                        <div class="form-group">
                            <label><span class="en">Date of Birth</span></label>
                            <input type="text" id="searchDob" placeholder="DD/MM/YYYY">
                        </div>
                        <div class="form-group">
                            <label><span class="en">School</span></label>
                            <select id="searchSchool">
                                <option value="">Select</option>
                                <option value="JCES">JCES</option>
                                <option value="Boctol">Boctol Elementary School</option>
                            </select>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="btn" onclick="searchStudent()"><span>üîç</span><span class="en">Search</span></button>
                        <button class="btn btn-success" onclick="newStudent()"><span>üÜï</span><span class="en">New
                                Student</span></button>
                    </div>
                    <div id="searchStatus" class="hidden"></div>
                    <div id="searchLoading" class="loading hidden">
                        <div class="spinner"></div>
                        <p>Searching...</p>
                    </div>
                </div>

                <!-- Student Info Display -->
                <div id="studentInfo" class="student-card hidden">
                    <h3><span class="en">üìã Student Information </span>
                    </h3>
                    <div class="info-grid">
                        <div class="info-item"><span class="info-label">Name:</span> <span
                                id="displayName"></span></div>
                        <div class="info-item"><span class="info-label">DOB:</span> <span
                                id="displayDob"></span></div>
                        <div class="info-item"><span class="info-label">School:</span> <span
                                id="displaySchool"></span></div>
                        <div class="info-item"><span class="info-label">Parent:</span> <span
                                id="displayParent"></span></div>
                        <div class="info-item"><span class="info-label">Contact:</span> <span
                                id="displayContact"></span></div>
                        <div class="info-item"><span class="info-label">Systemic:</span> <span
                                id="displaySystemic"></span></div>
                        <div class="info-item"><span class="info-label">Food Allergies:</span>
                            <span id="displayFoodAllergy"></span></div>
                        <div class="info-item"><span class="info-label">Medicine Allergies:</span>
                            <span id="displayMedAllergy"></span></div>
                    </div>
                </div>

                <!-- Student Edit Form -->
                <div id="studentForm" class="student-card hidden">
                    <h3><span class="en">üìù Edit Student Information / </span></h3>
                    <form id="studentInfoForm">
                        <div class="info-grid">
                            <div class="form-group"><label>Complete Name</label><input type="text"
                                    id="editName" required></div>
                            <div class="form-group"><label>Sex</label>
                                <select id="editSex">
                                    <option value="">Select</option>
                                    <option value="Male / Lalaki">Male</option>
                                    <option value="Female / Babae">Female</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Age</label><input type="text" id="editAge"></div>
                            <div class="form-group"><label>Date of Birth</label><input
                                    type="text" id="editDob" required placeholder="DD/MM/YYYY"></div>
                            <div class="form-group"><label>Address</label><input type="text" id="editAddress">
                            </div>
                            <div class="form-group"><label>School</label>
                                <select id="editSchool" required>
                                    <option value="">Select</option>
                                    <option value="JCES">JCES</option>
                                    <option value="Boctol">Boctol Elementary School</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Parent/Guardian</label><input type="text"
                                    id="editParent"></div>
                            <div class="form-group"><label>Contact Number</label><input type="text"
                                    id="editContact"></div>
                        </div>
                        <h4>Medical History</h4>
                        <div class="info-grid">
                            <div class="form-group"><label>Systemic Conditions</label><input type="text"
                                    id="editSystemic" placeholder="e.g., Asthma"></div>
                            <div class="form-group"><label>Food/Environment Allergies</label><input type="text"
                                    id="editFoodAllergy" placeholder="e.g., Dust"></div>
                            <div class="form-group"><label>Medicine Allergies</label><input type="text"
                                    id="editMedAllergy" placeholder="e.g., Penicillin"></div>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-success" onclick="saveStudentInfo()">üíæ Save Student
                                Info</button>
                        </div>
                    </form>
                </div>

                <!-- FDI Interactive Chart -->
                <div class="fdi-chart">
                    <div class="chart-title">ü¶∑ FDI Tooth Chart </div>
                    <div class="legend">
                        <span class="legend-item"><span class="legend-color"
                                style="background:var(--tooth-normal);"></span> N - Normal</span>
                        <span class="legend-item"><span class="legend-color"
                                style="background:var(--tooth-decayed);"></span> O - Decayed</span>
                        <span class="legend-item"><span class="legend-color"
                                style="background:var(--tooth-filled);"></span> F - Filled</span>
                        <span class="legend-item"><span class="legend-color"
                                style="background:var(--tooth-missing);"></span> M - Missing</span>
                        <span class="legend-item"><span class="legend-color"
                                style="background:var(--tooth-extract);"></span> X - Extract </span>
                    </div>
                    <!-- Permanent Teeth -->
                    <div class="quadrant-grid">
                        <div class="quadrant">
                            <div class="quadrant-title">Upper Right (11-18)</div>
                            <div class="tooth-row" id="upperRightPerm"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Upper Left (21-28)</div>
                            <div class="tooth-row" id="upperLeftPerm"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Lower Left (31-38)</div>
                            <div class="tooth-row" id="lowerLeftPerm"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Lower Right (41-48)</div>
                            <div class="tooth-row" id="lowerRightPerm"></div>
                        </div>
                    </div>
                    <!-- Baby Teeth -->
                    <div class="quadrant-grid">
                        <div class="quadrant">
                            <div class="quadrant-title">Upper Right Baby (51-55)</div>
                            <div class="tooth-row" id="upperRightBaby"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Upper Left Baby (61-65)</div>
                            <div class="tooth-row" id="upperLeftBaby"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Lower Left Baby (71-75)</div>
                            <div class="tooth-row" id="lowerLeftBaby"></div>
                        </div>
                        <div class="quadrant">
                            <div class="quadrant-title">Lower Right Baby (81-85)</div>
                            <div class="tooth-row" id="lowerRightBaby"></div>
                        </div>
                    </div>
                </div>

                <!-- Dental Exam Form (with notes) -->
                <div class="student-card">
                    <h3><span class="en">üìù Dental Examination </span></h3>
                    <form id="dentalExamForm">
                        <div class="info-grid">
                            <div class="form-group"><label>Tooth Extraction (FDI) </label><input type="text"
                                    id="toothExtraction" readonly placeholder="Click teeth above"></div>
                            <div class="form-group"><label>Tooth Filling (FDI) </label><input type="text"
                                    id="toothFilling" readonly placeholder="Click teeth above"></div>
                            <div class="form-group"><label>Tooth Decayed (FDI)</label>
                                <input type="text" id="toothDecayed" readonly placeholder="Click teeth above">
                            </div>
                            <div class="form-group"><label>Tooth Missing (FDI)</label>
                                <input type="text" id="toothMissing" readonly placeholder="Click teeth above">
                            </div>
                            <div class="form-group"><label>Fluoride (withing 1 year)</label><select id="fluoride">
                                    <option value="">Select</option>
                                    <option value="Oo">Yes</option>
                                    <option value="Hindi">No</option>
                                </select></div>
                            <div class="form-group"><label>Dental Consultations</label><select
                                    id="dentalConsult">
                                    <option value="">Select</option>
                                    <option value="Oo">Yes</option>
                                    <option value="Hindi">No</option>
                                </select></div>
                            <div class="form-group"><label>Severe Cavities</label><select
                                    id="severeCavities">
                                    <option value="">Select</option>
                                    <option value="Oo">Yes</option>
                                    <option value="Hindi">No</option>
                                </select></div>
                        </div>
                        <div class="form-group"><label>Oral Exam Notes</label><textarea
                                id="oralNotes" rows="2"></textarea></div>
                        <div class="form-group"><label>Cleaning Notes</label><textarea
                                id="cleaningNotes" rows="2"></textarea></div>
                        <div class="form-group"><label>Extraction Notes</label><textarea
                                id="extractionNotes" rows="2"></textarea></div>
                        <div class="form-group"><label>Filling Notes</label><textarea
                                id="fillingNotes" rows="2"></textarea></div>
                        <div class="form-group"><label>Remarks</label><textarea id="remarks"
                                rows="3"></textarea></div>
                        <div class="btn-group"><button type="submit" class="btn btn-success">üíæ Save Dental Record</button></div>
                    </form>
                    <div id="saveStatus" class="hidden"></div>
                </div>

                <!-- Previous Records List -->
                <div id="previousRecords" class="student-card hidden">
                    <h3><span class="en">üìã Previous Visits</span></h3>
                    <div id="recordsList" class="records-list"></div>
                </div>
            </div>

            <!-- TAB 2: Analysis Dashboard (iframe) -->
            <div id="tab2" class="tab-content hidden">
                <div class="iframe-container"><iframe src="analysis-dashboard/index.html"
                        title="Analysis Dashboard"></iframe></div>
            </div>

            <!-- TAB 3: Booking System (iframe) -->
            <div id="tab3" class="tab-content hidden">
                <div class="iframe-container"><iframe src="booking-system/index.html" title="Booking System"></iframe>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast hidden"></div>
    <script src="app.js"></script>
</body>

</html>